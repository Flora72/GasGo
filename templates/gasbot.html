<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>GasBot (AI Chat) | GasGo</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" href="{% static 'images/logo.png' %}" type="image/png">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link rel="shortcut icon" href="{% static 'images/logo.png' %}" type="image/png">
    <link rel="stylesheet" href="{% static 'css/bot.css' %}">
</head>
<body>
<header class="header">
    <a href="{% url 'index' %}" class="logo">GasGo</a>
    <nav>
        <ul>
            <li><a href="{% url 'index' %}">Home</a></li>
            <li><a href="{% url 'about' %}">About Us</a></li>
            <li><a href="{% url 'contact' %}">Contact Us</a></li>
            <li><a href="{% url 'signup' %}">Sign Up</a></li>
            <li><a href="{% url 'login' %}">Login</a></li>
        </ul>
    </nav>
</header>

<main>
    <section>
        <h1>Meet GasBot</h1>
        <p>GasBot is a simple AI-style chatbot that can answer common questions about GasGo — ordering LPG, delivery, vendors, tracking, safety and more. Type a question below to get started.</p>
        <p>Need human help? Email <a href="mailto:gasgosupport@gmail.com">gasgosupport@gmail.com</a> or see <a href="{% url 'emergency' %}">Emergency</a>.</p>
    </section>

<section>
  <h2>Chat</h2>
  <div class="chat-container">
    <div id="log" class="chat-log">
      <div class="bot-msg">GasBot: Hi! I can help with:<br>
        – Ordering and delivery<br>
        – Vendors and payment options<br>
        – Tracking your order<br>
        – Safety and emergencies<br>
        Ask me anything like “price for 13kg?”, “how to order?”, “track my order”, or “I smell gas”.
      </div>
    </div>
    <div class="chat-input">
      <input id="msg" type="text" placeholder="Type your question…" />
      <button id="send" type="button">Send</button>
    </div>
    <p class="chat-note">Note: Demo only — no personal data is stored. For urgent safety issues, call 999/112 and our toll‑free 0800 720 000.</p>
    <div class="chat-prompts">
      <button type="button" data-q="how do i order?">How do I order?</button>
      <button type="button" data-q="price 13kg">Price 13kg</button>
      <button type="button" data-q="track order">Track order</button>
      <button type="button" data-q="vendors near me">Vendors near me</button>
      <button type="button" data-q="i smell gas" data-emergency="1">I smell gas</button>
    </div>
  </div>

    <section class="gasbot-actions">
  <h2>Do more</h2>
  <ul>
    <li><a href="{% url 'orders' %}"><i class="fas fa-box"></i> Start an order</a></li>
<li><a href="{% url 'vendors' %}"><i class="fas fa-store"></i> See vendors</a></li>
<li><a href="{% url 'track_order' %}"><i class="fas fa-map-marker-alt"></i> Track an order</a></li>
<li><a href="{% url 'emergency' %}"><i class="fas fa-exclamation-triangle"></i> Emergency help</a></li>

  </ul>
</section>

</main>

<footer>
    <p>Follow Us:</p>
    <nav aria-label="Support and social">
        <a href="#"><i class="fab fa-facebook"></i> Facebook</a>
        <a href="#"><i class="fab fa-instagram"></i> Instagram</a>
        <a href="#"><i class="fab fa-x-twitter"></i> X</a>
    </nav>
    <small>&copy; {{ now|default:2025 }} GasGo. All rights reserved.</small>
</footer>
<script>
(function(){
    var log = document.getElementById('log');
    var msg = document.getElementById('msg');
    var send = document.getElementById('send');

    function append(line, sender = 'bot') {
  const div = document.createElement('div');
  div.className = sender === 'bot' ? 'bot-msg' : 'user-msg';
  div.textContent = line;
  log.appendChild(div);
  log.scrollTop = log.scrollHeight;
}

    function answer(text){
        var t = (text||'').trim().toLowerCase();
        function has(){ for (var i=0;i<arguments.length;i++){ if (t.indexOf(arguments[i]) !== -1) return true; } return false; }
        var reply = "I'm here to help. You can order via the Orders page, choose a vendor, then track delivery. What would you like to do?";

        if (has('how','order')){
            reply = "To order: go to Orders, choose size (6kg/13kg/22.5kg/35kg/50kg), enter your address and contact, then pick a vendor and payment. Start here: /orders/";
        } else if (has('price','cost','how much')){
            reply = "Indicative prices: 6kg ~ KSh 1,400–1,500; 13kg ~ KSh 3,050–3,200. Final price depends on brand/vendor and is confirmed on delivery.";
        } else if (has('13kg','13 kg')){
            reply = "13kg refills are typically KSh 3,050–3,150 depending on vendor. You can compare on the Vendors page before confirming.";
        } else if (has('vendor','near me','partners')){
            reply = "After you fill your order, we show available vendors near you with ETA, ratings and prices. See /vendors/ for examples.";
        } else if (has('track','tracking','where','rider')){
            reply = "You can track your rider live on the map here: /track_order/. Allow location for best accuracy.";
        } else if (has('pay','payment','mpesa','cash','card')){
            reply = "Payment options include Cash, M‑Pesa, or Card on delivery (depending on vendor). Choose on the Vendors confirmation step.";
        } else if (has('deliver','area','coverage','location')){
            reply = "We serve major Nairobi neighborhoods via partner vendors. Enter your address on the order form to see nearby options and ETA.";
        } else if (has('time','eta','how long','minutes','hours')){
            reply = "Typical ETA is 30–90 minutes depending on distance and traffic. You’ll see a live estimate after choosing a vendor.";
        } else if (has('safety','install','regulator','leak','smell','fire','burner')){
            if (has('fire')){
                reply = "If there is fire: evacuate immediately, call 999/112. If safe and trained, use a suitable extinguisher. Do not take risks.";
            } else if (has('smell','leak')){
                reply = "If you smell gas: close the valve if safe, open windows, avoid switches/flames, evacuate, call 999/112 and 0800 720 000.";
            } else if (has('install','regulator')){
                reply = "Installation tips: ensure regulator matches valve, check the O‑ring, secure the hose, and perform a soapy water leak test.";
            } else if (has('burner')){
                reply = "Burner not lighting: confirm gas is on, regulator locked, hose ok, try another ignition, and perform a leak check.";
            } else {
                reply = "Safety first: keep cylinders upright/ventilated, check seals/regulator fit, and use soapy water for leak checks.";
            }
        } else if (has('contact','help','support','agent','human')){
            reply = "You can reach our team at gasgosupport@gmail.com or via the Emergency page for urgent issues.";
        }
        append('GasBot: ' + reply);
    }

    function sendMsg(){
  const q = msg.value.trim();
  if (!q) return;
  append('You: ' + q, 'user');
  msg.value = '';
  append('GasBot is typing...', 'bot');
  setTimeout(() => {
    const last = log.lastChild;
    if (last && last.textContent.includes('typing')) log.removeChild(last);
    answer(q);
  }, 1000);
}
    if (send) send.addEventListener('click', sendMsg);
    if (msg) msg.addEventListener('keydown', function(e){ if (e.key === 'Enter'){ e.preventDefault(); sendMsg(); }});

    // Quick prompt buttons
    Array.prototype.forEach.call(document.querySelectorAll('button[data-q]'), function(btn){
        btn.addEventListener('click', function(){
            if (btn.getAttribute('data-emergency') === '1') {
                // Redirect to Emergency page when emergency prompt is clicked
                window.location.href = "{% url 'emergency' %}";
                return;
            }
            msg.value = btn.getAttribute('data-q');
            sendMsg();
        });
    });
})();
</script>
</body>
</html>
